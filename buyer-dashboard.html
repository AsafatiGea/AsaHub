<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buyer Dashboard ‚Äî AsaHub</title>
  <link rel="icon" type="image/png" href="img/logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/buyer.css">
  <link rel="stylesheet" href="css/responsive-mobile.css">
  <link rel="stylesheet" href="css/responsive-desktop.css">
  <link rel="stylesheet" href="css/buyer-dashboard-mobile.css">
</head>
<body>
  <div class="dashboard-wrapper">
    <div class="sidebar-overlay" aria-hidden="true"></div>

    <!-- ========== SIDEBAR ========== -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <span class="icon" aria-hidden="true">üõí</span>
          <span>AsaHub</span>
        </a>
        <button type="button" class="sidebar-collapse-btn" aria-label="Ciutkan sidebar">¬´</button>
        <button type="button" class="sidebar-close" aria-label="Tutup menu">&times;</button>
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li><a href="#" data-section="section-dashboard" class="active"><span class="icon">üìä</span><span>Dashboard</span></a></li>
          <li><a href="#" data-section="section-cart"><span class="icon">üõí</span><span>Keranjang</span></a></li>
          <li><a href="#" data-section="section-orders"><span class="icon">üìã</span><span>Pesanan Saya</span></a></li>
          <li><a href="#" data-section="section-history"><span class="icon">üìú</span><span>Riwayat Pembelian</span></a></li>
          <li><a href="#" data-section="section-profile"><span class="icon">üë§</span><span>Profil</span></a></li>
          <li><a href="#" data-section="section-address"><span class="icon">üìç</span><span>Alamat</span></a></li>
        </ul>
      </nav>
      <div class="sidebar-footer">
        <a href="login.html" class="logout-btn"><span class="icon">üö™</span><span>Logout</span></a>
      </div>
    </aside>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="main-content">
      <header class="top-navbar">
        <div class="navbar-left">
          <button type="button" class="sidebar-toggle" aria-label="Buka menu">‚ò∞</button>
          <h1 class="page-title">Buyer Dashboard</h1>
        </div>
        <div class="navbar-right">
          <div class="user-badge">
            <span class="avatar">B</span>
            <span>Buyer</span>
          </div>
        </div>
      </header>

      <div class="content-area">
        <!-- ---------- Section: Dashboard ---------- -->
        <section id="section-dashboard" class="dashboard-section active">
          <div class="welcome-empty">
            <h3>Selamat Datang di AsaHub! üéâ</h3>
            <p>Mulai belanja sekarang dan dapatkan pengalaman berbelanja yang menyenangkan</p>
            <a href="index.html" class="btn">Jelajahi Produk</a>
          </div>
          <div class="card">
            <h2 class="card-title">Ringkasan Pesanan</h2>
            <div class="stats-grid">
              <div class="stat-card">
                <h3>Pending</h3>
                <p class="value" id="buyer-stat-pending">0</p>
              </div>
              <div class="stat-card blue">
                <h3>Dikirim</h3>
                <p class="value" id="buyer-stat-shipped">0</p>
              </div>
              <div class="stat-card green">
                <h3>Selesai</h3>
                <p class="value" id="buyer-stat-done">0</p>
              </div>
            </div>
          </div>
          <div class="card">
            <h2 class="card-title">Pesanan Terkini</h2>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>ID Order</th>
                    <th>Total</th>
                    <th>Status</th>
                    <th>Tanggal</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="buyer-dashboard-orders">
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- ---------- Section: Keranjang ---------- -->
        <section id="section-cart" class="dashboard-section">
          <div class="card">
            <h2 class="card-title">Keranjang Belanja</h2>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>Produk</th>
                    <th>Seller</th>
                    <th>Harga</th>
                    <th>Qty</th>
                    <th>Subtotal</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="buyer-cart-tbody">
                </tbody>
              </table>
            </div>
            <div class="text-right mt-1">
              <strong>Total: <span id="cart-total">Rp 0</span></strong>
              <button type="button" class="btn btn-primary mt-1">Checkout</button>
            </div>
          </div>
        </section>

        <!-- ---------- Section: Pesanan Saya ---------- -->
        <section id="section-orders" class="dashboard-section">
          <div class="card">
            <h2 class="card-title">Pesanan Saya</h2>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>ID Order</th>
                    <th>Items</th>
                    <th>Total</th>
                    <th>Status</th>
                    <th>Tanggal</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="buyer-orders-tbody">
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- ---------- Section: Riwayat Pembelian ---------- -->
        <section id="section-history" class="dashboard-section">
          <div class="card">
            <h2 class="card-title">Riwayat Pembelian</h2>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>ID Order</th>
                    <th>Items</th>
                    <th>Total</th>
                    <th>Status</th>
                    <th>Tanggal</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="buyer-history-tbody">
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- ---------- Section: Profil ---------- -->
        <section id="section-profile" class="dashboard-section">
          <div class="card">
            <h2 class="card-title">Profil Saya</h2>
            <div class="profile-header">
              <div class="profile-avatar" id="buyer-avatar">B</div>
              <div class="profile-info">
                <h2 id="buyer-name">Nama Buyer</h2>
                <p id="buyer-email" class="text-muted">buyer@example.com</p>
              </div>
            </div>
            <form id="form-buyer-profile" style="max-width: 560px;">
              <div class="form-group">
                <label for="buyer-name-input">Nama Lengkap</label>
                <input type="text" id="buyer-name-input" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="buyer-email-input">Email</label>
                <input type="email" id="buyer-email-input" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="buyer-phone">Nomor HP</label>
                <input type="tel" id="buyer-phone" class="form-control" placeholder="08xxxxxxxxxx">
              </div>
              <div class="form-group">
                <label for="buyer-address">Alamat Pengiriman</label>
                <textarea id="buyer-address" class="form-control" rows="3" placeholder="Alamat lengkap"></textarea>
              </div>
              <div class="form-group">
                <label>Foto Profil</label>
                <input type="file" id="buyer-photo" class="form-control" accept="image/*">
              </div>
              <button type="submit" class="btn btn-primary">Simpan Profil</button>
            </form>
          </div>
        </section>

        <!-- ---------- Section: Alamat ---------- -->
        <section id="section-address" class="dashboard-section">
          <div class="card">
            <h2 class="card-title">Daftar Alamat</h2>
            <p class="text-muted mb-0">Kelola alamat pengiriman.</p>
            <div id="buyer-address-list" class="mt-1">
              <!-- Diisi JS -->
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- ========== MOBILE NAVIGATION ========== -->
    <nav class="mobile-nav">
      <a href="#" data-section="section-dashboard" class="mobile-nav-item active">
        <span class="mobile-nav-icon">üìä</span>
        <span>Dashboard</span>
      </a>
      <a href="#" data-section="section-cart" class="mobile-nav-item">
        <span class="mobile-nav-icon">üõí</span>
        <span>Keranjang</span>
      </a>
      <a href="#" data-section="section-orders" class="mobile-nav-item">
        <span class="mobile-nav-icon">üìã</span>
        <span>Pesanan</span>
      </a>
      <a href="#" data-section="section-profile" class="mobile-nav-item">
        <span class="mobile-nav-icon">üë§</span>
        <span>Profil</span>
      </a>
    </nav>
  </div>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7"></script>
  <!-- Local JS -->
  <script src="js/supabase-config.js"></script>
  <script src="js/auth-service.js"></script>
  <script src="js/buyer.js"></script>
  <script>
    (function () {
      // Initialize with empty data - no dummy data
      var orders = [];
      var cart = [];
      var profile = {};
      var addresses = [];

      // Initialize stats to 0
      document.getElementById('buyer-stat-pending').textContent = '0';
      document.getElementById('buyer-stat-shipped').textContent = '0';
      document.getElementById('buyer-stat-done').textContent = '0';

      // Empty dashboard orders
      document.getElementById('buyer-dashboard-orders').innerHTML = '<tr><td colspan="5" class="empty-state">Belum ada pesanan</td></tr>';

      // Empty orders tables
      document.getElementById('buyer-orders-tbody').innerHTML = '<tr><td colspan="6" class="empty-state">Belum ada pesanan</td></tr>';
      document.getElementById('buyer-history-tbody').innerHTML = '<tr><td colspan="6" class="empty-state">Belum ada riwayat pembelian</td></tr>';

      // Empty cart
      document.getElementById('buyer-cart-tbody').innerHTML = '<tr><td colspan="6" class="empty-state">Keranjang kosong</td></tr>';
      document.getElementById('cart-total').textContent = 'Rp 0';

      // Empty profile - will be loaded from auth service
      document.getElementById('buyer-name').textContent = 'Loading...';
      document.getElementById('buyer-email').textContent = 'Loading...';
      document.getElementById('buyer-avatar').textContent = '?';

      // Empty addresses
      document.getElementById('buyer-address-list').innerHTML = '<p class="text-muted">Belum ada alamat tersimpan</p>';

      // Section switching
      function showSection(id) {
        document.querySelectorAll('.dashboard-section').forEach(function(s) {
          s.classList.remove('active');
        });
        document.getElementById(id).classList.add('active');
      }

      // Navigation
      document.querySelectorAll('.sidebar-nav a').forEach(function(link) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          var section = this.getAttribute('data-section');
          showSection(section);
          updateMobileNav(section);
        });
      });

      // Mobile navigation
      document.querySelectorAll('.mobile-nav-item').forEach(function(link) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          var section = this.getAttribute('data-section');
          showSection(section);
          updateMobileNav(section);
        });
      });

      function updateMobileNav(section) {
        document.querySelectorAll('.mobile-nav-item').forEach(function(item) {
          item.classList.remove('active');
        });
        document.querySelector('.mobile-nav-item[data-section="' + section + '"]').classList.add('active');
      }

      // Mobile sidebar toggle
      var sidebarToggle = document.querySelector('.sidebar-toggle');
      var sidebar = document.querySelector('.sidebar');
      var sidebarOverlay = document.querySelector('.sidebar-overlay');

      console.log('Sidebar elements:', {
        toggle: sidebarToggle,
        sidebar: sidebar,
        overlay: sidebarOverlay
      });

      if (sidebarToggle) {
        sidebarToggle.addEventListener('click', function() {
          console.log('Sidebar toggle clicked!');
          sidebar.classList.add('active');
          sidebarOverlay.classList.add('active');
        });
      } else {
        console.log('Sidebar toggle not found!');
      }

      if (sidebarOverlay) {
        sidebarOverlay.addEventListener('click', function() {
          console.log('Sidebar overlay clicked!');
          sidebar.classList.remove('active');
          sidebarOverlay.classList.remove('active');
        });
      }

      // Sidebar close button
      var sidebarClose = document.querySelector('.sidebar-close');
      if (sidebarClose) {
        sidebarClose.addEventListener('click', function() {
          console.log('Sidebar close clicked!');
          sidebar.classList.remove('active');
          sidebarOverlay.classList.remove('active');
        });
      }

      // Profile form handler
      document.getElementById('form-buyer-profile').addEventListener('submit', function (e) {
        e.preventDefault();
        alert('Fitur simpan profil akan tersedia setelah terhubung dengan database');
      });

      // Initialize buyer dashboard
      if (window.buyerManager) {
        window.buyerManager.init();
      }
    })();
  </script>
</body>
</html>