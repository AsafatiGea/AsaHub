<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masuk - AsaHub</title>
    <link rel="icon" type="image/png" href="../img/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- CSS Modular -->
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/auth.css">
    <link rel="stylesheet" href="../css/responsive-mobile.css">
    <link rel="stylesheet" href="../css/responsive-desktop.css">
</head>
<body>

<div class="auth-container">
    <div class="auth-card fade-in">
        <div class="auth-header">
            <a href="../index.html" class="auth-logo">Asa<span>Hub</span></a>
            <h1 class="auth-title">Selamat Datang</h1>
            <p class="auth-subtitle">Masuk ke akun AsaHub kamu</p>
        </div>

        <div class="auth-message error" id="alertError">Email atau password salah.</div>
        <div class="auth-message success" id="alertSuccess">Berhasil masuk! Mengarahkan...</div>

        <form class="auth-form" onsubmit="doLogin(event)">
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" id="email" placeholder="nama@email.com" required>
            </div>
            <div class="form-group">
                <label class="form-label">Password</label>
                <div class="password-input-wrapper">
                    <input type="password" class="form-input" id="password" placeholder="Password kamu" required>
                    <button type="button" class="password-toggle" onclick="togglePassword()">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
            </div>

            <div class="form-options">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="remember">
                    <label for="remember">Ingat saya</label>
                </div>
                <a href="#" class="forgot-password">Lupa password?</a>
            </div>

            <button type="submit" class="auth-button primary">
                <span id="loginText">Masuk</span>
                <div class="auth-loading" id="loginLoading" style="display: none;"></div>
            </button>
        </form>

        <div class="auth-divider">
            <span>atau</span>
        </div>

        <div class="social-login">
            <a href="#" class="social-button google">
                <i class="fab fa-google"></i>
                Masuk dengan Google
            </a>
            <a href="#" class="social-button facebook">
                <i class="fab fa-facebook-f"></i>
                Masuk dengan Facebook
            </a>
        </div>

        <div class="auth-footer">
            <p>Belum punya akun? <a href="daftar.html">Daftar di sini</a></p>
            <p><a href="../index.html">‚Üê Kembali ke Marketplace</a></p>
        </div>
    </div>
</div>

<script>
function togglePassword() {
    const passwordInput = document.getElementById('password');
    const toggleIcon = document.querySelector('.password-toggle i');
    
    if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.className = 'fas fa-eye-slash';
    } else {
        passwordInput.type = 'password';
        toggleIcon.className = 'fas fa-eye';
    }
}

function doLogin(event) {
    event.preventDefault();
    
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const loginText = document.getElementById('loginText');
    const loginLoading = document.getElementById('loginLoading');
    const alertError = document.getElementById('alertError');
    const alertSuccess = document.getElementById('alertSuccess');
    
    // Show loading state
    loginText.style.display = 'none';
    loginLoading.style.display = 'inline-block';
    
    // Simulate API call
    setTimeout(() => {
        const users = JSON.parse(localStorage.getItem('asahub_users') || '[]');
        const found = users.find(u => u.email === email && u.password === password);
        
        // Demo akun default
        const isDemo = (email === 'admin@asahub.site' && password === 'admin123');
        
        if (found || isDemo) {
            const user = found || { name: 'Admin User', email, role: 'admin' };
            localStorage.setItem('asahub_current_user', JSON.stringify(user));
            
            alertSuccess.classList.add('show');
            alertError.classList.remove('show');
            
            // Redirect berdasarkan role
            let redirectUrl = '../index.html';
            if (user.role === 'admin') {
                redirectUrl = '../Stakeholder/admin-dashboard.html';
            } else if (user.role === 'penjual') {
                redirectUrl = '../Stakeholder/seller-dashboard.html';
            } else if (user.role === 'pembeli') {
                redirectUrl = '../Stakeholder/buyer-dashboard.html';
            }
            
            setTimeout(() => { 
                window.location.href = redirectUrl; 
            }, 1200);
        } else {
            // Show error
            alertError.classList.add('show');
            alertSuccess.classList.remove('show');
            
            // Reset loading state
            loginText.style.display = 'inline';
            loginLoading.style.display = 'none';
            
            // Shake animation for error
            document.querySelector('.auth-card').style.animation = 'shake 0.5s';
            setTimeout(() => {
                document.querySelector('.auth-card').style.animation = '';
            }, 500);
        }
    }, 1000);
}

// Add shake animation
const style = document.createElement('style');
style.textContent = `
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}
`;
document.head.appendChild(style);

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    // Focus on email input
    document.getElementById('email').focus();
});
</script>
</body>
</html>